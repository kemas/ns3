import sys
import json
import plot as p

def getargval(dictarg, key, ifnone=p.IFNONE):
    if dictarg.has_key(key):
        return dictarg[key]
    else:
        return ifnone

def loadarg(lsarg):
    ds = []
    for i in range(len(lsarg)):
        func = lsarg[i]['func'][0]

        step = p.STEP
        argstep = getargval(lsarg[i], '-j')
        if argstep:
            step = int(argstep[0])

        for finjson in lsarg[i]['files']:
            f = open(finjson)
            try:
                data = json.load(f)

                p.loaddata(ds, func, data, finjson, step)
            finally:
                f.close()

        xlim = getargval(lsarg[i], '-xlim')
        ylim = getargval(lsarg[i], '-ylim')

        plotfile = getargval(lsarg[i], '-v', [None])[0]

        axisfsize = getargval(lsarg[i], '-axisfsize', ['medium'])[0]
        try:
            axisfsize = int(axisfsize)
        except:
            pass

    return ds

def main(argv):
    indegarg = [{'func':['-id'], 'files':['simdata/svcsimn_d2a1_1.json'], '-m':['tricol'], '-t':['In-degree of random failed nodes in cascading failure'], '-xl':['time'], '-yl':['In-degree'], '-l':['In-degree'], '-loc':[2], '-axisfsize':['large']}]
    totdegarg = [{'func':['-td'], 'files':['simdata/svcsimn_d2a1_1.json'], '-m':['plus'], '-yl':['Total in-degree'], '-l':['Total in-degree'], '-axisfsize':['large'], '-loc':[4]}]

    ax = p.plt.axes([0.13, 0.12, 0.6, 0.78])
    ax2 = p.plt.twinx(ax)



        if i == 0:
            #func == p.FUNC_DISTINDEG:
            p.plotdegdist(ds
                , getargval(lsarg[i], '-l')
                , getargval(lsarg[i], '-m', ['var'])[0]
                , title=getargval(lsarg[i], '-t', [''])[0]
                , xylabels={'x': getargval(lsarg[i], '-xl', [''])[0], 'y': getargval(lsarg[i], '-yl', [''])[0]}
                , nbins=int(getargval(lsarg[i], '-b', ['50'])[0])
                , logx=logx, logy=logy
                , xlim=xlim
                , ylim=ylim
                , legloc=int(getargval(lsarg[i], '-loc', [2])[0])
                , axisfsize=axisfsize
                , ax=ax)
                #, ax=p.plt.twinx(p.plt.gca()))
                #, ax=p.plt.gca())

            ax.set_ylabel(ax.get_ylabel(), color='#460046')
            for tl in ax.get_yticklabels():
                tl.set_color('#460046')

        elif i == 1:
            #func == p.FUNC_LOGINDEG:

            p.drawloglogdist(ds
                , xlabel=getargval(lsarg[i], '-xl', [''])[0]
                , ylabel=getargval(lsarg[i], '-yl', [''])[0]
                , title=getargval(lsarg[i], '-t', [''])[0]
                , labels=getargval(lsarg[i], '-l')
                , markset=getargval(lsarg[i], '-m', ['var'])[0]
                , xlim=xlim
                , ylim=ylim
                , axisfsize=axisfsize
                , legloc=int(getargval(lsarg[i], '-loc', [2])[0])
                , logbinbase=lb
                , showexp=int(getargval(lsarg[i], '-g', [1])[0])
                , ax=ax2)
                #, ax=p.plt.twinx(ax))
                #, ax=p.plt.twinx(p.plt.gca()))

            ax2.set_ylabel(ax2.get_ylabel(), color='#003200')
            for tl in ax2.get_yticklabels():
                tl.set_color('#003200')

    p.processplot(p.plt, getargval(lsarg[i], '-s', [None])[0])

if __name__ == '__main__':
    sys.exit(main(sys.argv))

